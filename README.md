# MAT
Monte-Carlo Tree Search adversarial training methodology
# MAT

This repo contains the MAT toolkit for robust models against different attacks. 

The Monte-Carlo tree search robust optimisation toolkit includes the robust optimisation function
applied in a training model. This is divided into two steps: the first consists of an attack
generation step; the second is a robust optimisation step. For the attack generation part, first, a
model is pre-trained as an assistant classifier from a training dataset of images. Then, the
procedure follows a training loop. In each training loop, corresponding to a training epoch, a
minibatch of size m of images is randomly selected from the training dataset. This minibatch is
then analysed by the MAT method to generate adversarial examples. Whether or not the
images generated by MAT are proper adversarial examples is determined by a test on the
assistant classifier. The resulting adversarial examples form the basis for training the robust
model. The training loop continues for as many epochs as required until the required accuracy is
converged. 


## Installation

### All packages in this toolkit
    Python 3.6 
    Package             Version      
    ------------------- -------------
    absl-py             0.2.2        
    astor               0.7.1        
    boto                2.49.0       
    certifi             2018.4.16    
    cloudpickle         0.5.3        
    cvxopt              1.2.0        
    cycler              0.10.0       
    dask                0.18.1       
    decorator           4.3.0        
    gast                0.2.0        
    grpcio              1.13.0       
    h5py                2.8.0        
    intel-openmp        2018.0.3     
    Keras               1.2.2        
    Keras-Applications  1.0.2        
    Keras-Preprocessing 1.0.1        
    kiwisolver          1.0.1        
    Markdown            2.6.11       
    matplotlib          2.2.2        
    mkl                 2018.0.3     
    networkx            2.1          
    numpy               1.14.5       
    opencv-python       3.4.2+contrib
    Pillow              5.2.0        
    pip                 10.0.1       
    protobuf            3.6.0        
    pyparsing           2.2.0              
    python-dateutil     2.7.3        
    pytz                2018.5       
    PyWavelets          0.5.2        
    PyYAML              3.13         
    scikit-image        0.14.0       
    scipy               1.1.0        
    setuptools          39.1.0       
    six                 1.11.0       
    stopit              1.1.2        
    tensorboard         1.9.0        
    tensorflow-gpu      1.9.0        
    termcolor           1.1.0        
    Theano              1.0.2        
    toolz               0.9.0        
    Werkzeug            0.14.1       
    wheel               0.31.1       
    wincertstore        0.2  

## Usage

### MNIST Inputs
1) Fetch datasets from http://yann.lecun.com/exdb/mnist/ into MNIST_data
2) Config the config.json file for different parameters
3) Create directory and start training
```
# create directories for models and images
$ mkdir models image
# start training model
$ python train.py
```

### MNIST Outputs
    Robust model: all the trained models will be in the models directory
    Images: all adversarial examples will be in the image directory
    Adversarial images in .npy

### CIFAR10 Inputs
1) Fetch datasets from https://www.cs.toronto.edu/~kriz/cifar.html into cifar10_data
2) Config the config.json file for different parameters
3) Create directory and start training
```
# create directories for models and images
$ mkdir models image
# start training model
$ python train.py
```

### CIFAR10 Outputs
Robust model: all the trained models will be in the models directory
Images: all adversarial examples will be in the image directory
Adversarial images in .npy

## Authors

Yi-Ling Liu

## Disclaimer
The code here contained is provided to assist with reviewing the IJCAI paper number 1137. No permission is given or implied for copying, or using the attached software for other purposes.
